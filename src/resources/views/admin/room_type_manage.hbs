<div class="container-xl">
    <div class="row">
        <div class="col-sm-6 d-flex align-items-center">
            <div class="btn shadow p-3 mb-4 bg-body rounded">
                <img class="img-flud" style="max-height: 36px;" src="img/icons/price-tag.png">
            </div>
            <div class="px-4">
                <h5>Quản lý loại phòng</h5>
                <p class="text-muted">View, create, update, delete and manage</p>
            </div>
        </div>
        <div class="col-sm-6 d-flex align-items-center justify-content-end">
            <a href="#" class="create btn btn-primary d-flex align-items-center rounded mx-1" data-bs-toggle="modal"
                data-bs-target="#createModal">
                <i class="material-icons me-2">&#xE147;</i><span>Thêm mới</span>
            </a>
        </div>
    </div>

    <div class="table-responsive shadow rounded">
        <div class="table-wrapper">
            <div class="table-title">
                <div class="row">
                    <div class="col-sm-8">
                        <h2>Danh sách <b>loại phòng</b></h2>
                    </div>
                    <div class="col-sm-4">
                        <div class="search-box">
                            <i class="material-icons">&#xE8B6;</i>
                            <input type="text" class="form-control" id="searchInput" onkeyup="searchBox()"
                                placeholder="Search&hellip;">
                        </div>
                    </div>
                </div>
            </div>
            <table class="table table-striped table-hover table-bordered" id="myTable">
                <thead>
                    <tr>
                        <th onclick="sortBy(0)">No.<i class="fa fa-sort"></i></th>
                        <th onclick="sortBy(1)">Tên loại phòng<i class="fa fa-sort"></i></th>
                        <th onclick="sortBy(2)">Mã loại phòng<i class="fa fa-sort"></i></th>
                        <th>Hành động<i class="fa fa-sort"></i></th>
                    </tr>
                </thead>
                <tbody>
                    {{#each roomTypes}}
                    <tr>
                        <td>{{no1 @index }}</td>
                        <td>{{ name }}</td>
                        <td>{{ shortcode }}</td>
                        <td>
                            <a href="#" class="settings" title="Settings" data-toggle="tooltip" data-bs-toggle="modal" 
                                data-bs-target="#updateModal" data-id="{{ id }}" data-name="{{ name }}" data-shortcode="{{ shortcode }}"><i
                                    class="material-icons">&#xE8B8;</i></a>
                            <a href="#" class="delete" title="Delete" data-toggle="tooltip" data-bs-toggle="modal"
                                data-bs-target="#confirmModal" data-id="{{ id }}"><i
                                    class="material-icons">&#xE5C9;</i></a>
                        </td>
                    </tr>
                    {{/each}}
                </tbody>
            </table>
            <div class="clearfix">
                <div class="hint-text">Showing <b>5</b> out of <b>25</b> entries</div>
                <ul class="pagination">
                    <li class="page-item disabled"><a href="#">Previous</a></li>
                    <li class="page-item"><a href="#" class="page-link">1</a></li>
                    <li class="page-item"><a href="#" class="page-link">2</a></li>
                    <li class="page-item active"><a href="#" class="page-link">3</a></li>
                    <li class="page-item"><a href="#" class="page-link">4</a></li>
                    <li class="page-item"><a href="#" class="page-link">5</a></li>
                    <li class="page-item"><a href="#" class="page-link">Next</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Modal Delete -->
    <div id="confirmModal" class="modal fade" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-confirm">
            <div class="modal-content">
                <div class="d-flex justify-content-end">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-header">
                    <div class="icon-box">
                        <i class="material-icons">&#xE5CD;</i>
                    </div>
                    <h4 class="modal-title">Bạn chắc chứ?</h4>
                </div>
                <div class="modal-body">
                    <p>Bạn có chắn chắn rằng muốn xóa thông tin phòng này? Hành động này không thể khôi phục lại.
                    </p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-info" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-danger btn-delete" id="delete">Delete</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Create -->
    <div id="createModal" class="modal fade" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <form method="post" action="">
                    <div class="modal-header">
                        <h5 class="modal-title"> Thêm mới loại phòng </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-xl-8 col-lg-8 col-md-8 col-sm-8 col-12 mb-3">
                                <label class="form-label" for="name">Tên Loại Phòng</label>
                                <input type="text" class="form-control" id="name" name="name" required>
                            </div>
                            <div class="col-xl-4 col-lg-4 col-md-4 col-sm-4 col-12 mb-3">
                                <label class="form-label" for="shortcode">Short Code</label>
                                <input type="text" class="form-control" id="shortcode" name="shortcode" required>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-outline-secondary btn-reset" type="reset">
                            <i class="fas fa-redo-alt"></i>
                        </button>
                        <button class="btn btn-success text-white mx-2" type="submit">
                            <i class="fas fa-save me-2"></i><span>Lưu</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal Update -->
    <div id="updateModal" class="modal fade" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <form method="post" action="">
                    <div class="modal-header">
                        <h5 class="modal-title"> Thêm mới loại phòng </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>

                    <div class="modal-body">
                        <div class="row">
                            <div class="col-xl-8 col-lg-8 col-md-8 col-sm-8 col-12 mb-3">
                                <label class="form-label" for="name">Tên Loại Phòng</label>
                                <input type="text" class="form-control" id="name_edit" name="name"
                                    required>
                            </div>
                            <div class="col-xl-4 col-lg-4 col-md-4 col-sm-4 col-12 mb-3">
                                <label class="form-label" for="shortcode">Short Code</label>
                                <input type="text" class="form-control" id="shortcode_edit" name="shortcode"
                                    required>
                            </div>
                        </div>
                    </div>

                    <div class="modal-footer">
                        <button class="btn btn-outline-secondary btn-reset" type="reset">
                            <i class="fas fa-redo-alt"></i>
                        </button>
                        <button class="btn btn-warning text-white mx-2" type="submit">
                            <i class="fas fa-edit me-2"></i><span>Cập nhật</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
        let x = document.querySelectorAll(".price");
        for (let i = 0; i < x.length; i++) {
            let num = Number(x[i].innerHTML).toLocaleString('en');
            x[i].innerHTML = num + ' VNĐ';
        }

        $('.delete').on('click', function () {
            let id_val = $(this).data('id');
            $('.btn-delete').attr('data-id', id_val);
        })

        $('.btn-delete').on('click', function () {
            let id_delete = $('.btn-delete').attr('data-id');

            $.ajax({
                type: 'DELETE',
                url: 'room_types/delete/' + id_delete,
                success: function (data) {
                    window.location.reload();
                },
                error: function (err) {
                    console.log(err);
                }
            })
        });

        $('.settings').on('click', function () {
            let id_val = $(this).data('id');
            const name = document.getElementById('name_edit');
            const shortcode = document.getElementById('shortcode_edit');

            name.value = $(this).data('name');
            shortcode.value  = $(this).data('shortcode');

            $('#updateModal form').attr('action', 'room_types/update/' + id_val);
        })
    })
</script>